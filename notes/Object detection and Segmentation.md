---
layout: page
permalink: notes/object-detection-and-segmentation
tags: en
title: Object detection and Segmentation
---

### Definition of problems
#### Object detection
Bisogna trovare all'interno dell'immagine quali siano gli oggetti presenti, e in pi√π **vogliamo sapere dove siano** quindi utilizzare una bounding box per caratterizzarli sarebbe buono.

#### Object segmentation
√à riuscire a caratterizzare categoria per categoria per **singoli pixels**m e per questo motivo potrei riuscire a fare delle image map in cui colorare singoli oggetti in una categoria.

### Datasets

#### Pascal VOC 2012
Un po'vecchio come dataset, ha circa 20k immagini (quindi un po' poche).

#### COCO dataset
Si utilizza ancora questo

#### Cityscapes dataset
#### Autogenerated datasets

#### Applicazioni
- Auto drive
- Campo medico (per segmentazione medica o riconoscimento immagini).
- reidentificazione.
- Key posse extimations.

### Technologies

#### U-net
Il primo skip connection ci permette di capire bene quali siano i bordi, perch√© sappiamo che la convoluzione riesce a prendere bene 

#### Region proposals and single shots

**Region proposals:**
(R-CNN, Fast R-CNN, Faster R-CNN).

Il primo √® un vecchio metodo per attaccare il problema.
In passato si analizzava la texture per capire le regioni con struttura e dove si avevano altre, utilizzato per avere zone di interesse, senza informazioni semantiche a riguardo.
una volta capite le regioni di interesse l'altra rete prova a fare classificazione e bounding box.

**Single shots**
(Yolo, SSD, Retina-net, FPN).

Si fanno in unica passata indetificazione del luogo e categorizzazione.

#### Architettura di Yolo
1. Downsampling, fare dei mini quadratini, 32 fattori di downsampling, di solito l'immagine √® 416x416 e arriva a 13x13.
2. Ogni neurone fa tre predizioni.
3. Quattro valori per una bounding box (offsettata dal neurone), quanto penso di essere sicuro, e poi dire cosa esattamente sto vedendo.

Importante avere la **funzione di loss** per analizzare bene. Vogliamo avere un singolo neurone, quindi forzo a zero tutti gli altri neuroni.
<img src="/images/notes/Object detection and Segmentation-1701855390753.jpeg" alt="Object detection and Segmentation-1701855390753">
Questo √® quello che faccio con la funzione maschera per avere solamente la box di interesse.
Poi una volta definito questo provo a definire **errore di localizzazione** e l'errore di **classificazione**.
Quello √® l'errore di di localizzazione in cui vogliamo avere la bounding box pi√π corretta.
La radice √® una euristica umana per cercare di favorire il punto principale (ma cambia la loss fra versione all'altra).

<img src="/images/notes/Object detection and Segmentation-1701855589245.jpeg" alt="Object detection and Segmentation-1701855589245">
Una volta che ho le due loss posso provare a bilanciarle:

$$
L = \lambda_{c}L_{loc} + L_{cls}
$$

E le variabili si mettono a mano seconda dell'architettura.


#### Intersection over Union

#### Non-maximum-suppression algorithms üü©
√à un modo per trovare le bounding box migliori per un certo argomento.
In pratica √® un algoritmo greedy, che va cos√¨:
1. Sorta tutte le bounding box in ordine decrescente di confidence
2. Prendo la prima come vera
3. Le prossime le elimino se hanno una intersection over union alta, altrimenti le tengo.
4. Cos√¨ finch√© non finiscono tutte le bounding box.